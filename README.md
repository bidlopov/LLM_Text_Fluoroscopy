# Text Fluoroscopy Detector

Проект реализует метод [Text Fluoroscopy](https://aclanthology.org/2024.emnlp-main.885) для определения авторства текста (LLM или человек).

В проекте используется открытая модель `thenlper/gte-base` и MLP-классификатор, обучаемый на признаках, извлечённых из внутренних представлений этой модели.

Модель gte-base имеет 12 слоев, среди которых диапазон 4-8 не влючает в себя эмбеддинг/лингвистику/семантику, то есть 
соответствует выбранным в статье слоям 5-20 для модели `se gte-Qwen1.5-7B-instr`

## Порядок установки

1. клонировать репозиторий
2. установить зависимости из requirements.txt
		В текущей версии неочищенный список, в процессе разработки установил много package и не удалил лишние.

## Порядок выполнения

1. Запустить скрипт smaller_dataset.py
		Этот скрипт уменьшает исходный датасет из 20000 позиций до 1000
2. Запустить скрипт train_classifier.py
		Будет сгенерирован файл модели fluoroscopy_mlp.joblib, а также
		сгенерирован отчет о точности на данной выборке (проверка на переобучение)
3. Запустить скрипт predict.py
		Будет сгенерирован график, описывающий вероятность авторства LLM/человек
		(results.png)

Если хотите использовать статический средний слой, а не выбирать его динамически на основе KL, то
1. запускать скрипты extract_features_fixed.py и train_classifier_fixed.py
2. в predict.py заменить закомментированные строки в начале и конце скрипта (не fixed <-> fixed)

## Результат применения метода

- Модель не переобучается
- Показывает удовлетворительные результаты предсказания (см. result.png и result_fixed.png)
- (TO-DO) возможна замена на другую, более объемную модель, с сохранением удовлетворительного результата